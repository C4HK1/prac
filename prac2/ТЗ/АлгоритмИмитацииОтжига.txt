Оптимизационные методы искусственного
интеллекта
Костенко Валерий Алексеевич
МГУ им. М.В. Ломоносова,
факультет ВМК
kost@cs.msu.su
Сайт: https://asvk.cs.msu.ru/
2025 г.
.
Алгоритмы имитации отжига
.
Алгоритм основывается на имитации физического процесса, который
происходит при отжиге металлов.
Предполагается, что атомы уже выстроились в кристаллическую решётку,
но ещё допустимы переходы отдельных атомов из одной ячейки в другую.
Переход атома из одной ячейки в другую происходит с некоторой
вероятностью, причём вероятность уменьшается с понижением
температуры.
Устойчивая кристаллическая решётка соответствует минимуму энергии
атомов, поэтому атом или переходит в состояние с меньшим уровнем
энергии, или остаётся на месте.
Вероятностный закон принятия нового
решения текущим решением
• Алгоритмы имитации отжига с некоторой вероятностью
допускают переход в состояние с более высоким значением
целевой функции:
• где T - некоторая температура, - изменение целевой
функции.
• В ходе работы алгоритма температура постепенно снижается.




   
 
 

exp( ), 0
1, 0
( )
1
F
T
F
F
P X X
k k
F
Общая схема
1. Задать начальное корректное решение X0S и считать его текущим
вариантом решения: X=X0
.
2. Установить начальную температуру Т0
, приняв ее текущей: Т=Т0
3. Применить операции преобразования решения к X и получить новый
вариант решения X' S,
4. Найти изменение функции оценки качества решения : F = F(X' ) -
F(X):
– если F ≤ 0 (решение улучшилось), то X=X';
– если F > 0 , то принять с вероятностью P в качестве текущего
решения новый вариант решения X';
– если это решение является лучшим из ранее найденных, то
запомнить его.
5. Повторить заданное число раз шаги 3 и 4 без изменения текущей
температуры.
6. Если критерий останова выполнен, то завершение работы.
7. Понизить текущую температуру в соответствии с выбранным законом
понижения и перейти к шагу 3..
.
Вероятность принятия решения на шаге 4:
Законы понижения температуры на шаге 7:
•Закон Больцмана:
• Закон Коши:
•.
i - номер итерации алгоритма
T
F
p e
 

ln(1 )
0
i
T
T


i
T
T


1
0
i
i
T T



1
ln(1 )
0
.
1. Разработать способ представления решения X и
операций преобразования текущего решения на шаге 3.
Должны удовлетворять условиям:
– замкнутости,
– полноты.
2. Разработать стратегию применения операций
преобразования текущего решения на шаге 3:
– какую операцию применять,
– к какому элементу X, как его изменять.
3. Выбрать закон понижения температуры на шаге 7.
4. Определить функцию для оценки качества текущего
решения на шаге 4.
5. Выбрать критерий останова алгоритма, используемый на
шаге 6.
Штрафные и барьерные функции
Пусть ищется минимальное значение функции F( x ) и переменная x
 ограничена значением, строго меньшим, чем заданная константа b.
Штрафная функция F(x)+g(x) — непрерывная функция, значение
которой при нарушении границы области допустимых решений
увеличивается по сравнению со значение целевой функции на
значение функции g(x).
Барьерная функция — непрерывная функция, значение которой
стремится к бесконечности при приближении точки к границе
области допустимых решений.
Что бы алгоритм не выходил из области допустимых решений
функция F(x) может быть заменена на функцию F(x )− g(x,b).
Для логарифмических барьерных функций g(x,b) определяется как
log(b − x) для всех x<b и ∞ в противном случае .
log(b − x) будет стремится к минус бесконечности, когда ( b − x )
стремится к нулю.
Асимптотическая скорость сходимости
Чтобы достичь наперед заданной точности,
нужно совершить число итераций,
пропорциональное квадрату от размера
пространства поиска.
.
Повышение эффективности алгоритма
•Динамические законы понижения температуры.
•Распараллеливание алгоритмов.
•Эвристические (направленные) операции
преобразования текущего решения.
Задача построения расписания
• Модель программы H задается
графом потока данных H = {P, L} :
– P = { Pi } – множество работ,
– L – ограничения на порядок
выполнения работ.
• Метки работ pi
:
– Ni
 – номер,
– Wi
 - вычислительная сложность.
7
1 3
6
4 5
2
Модель расписания
порядок выполнения работ
 множество всех процессоров
 множество всех работ
: * привязка работ
( , )
расписание



 


L
B
B L
HP
PU
p*
HP p PU
HP HP HP
HP
SP1
:
SP2
:
2 3 6
1
5
4
7
7
1 3
6
4 5
2
Условия корректности расписания
• ацикличность
• частичный порядок заданный в H, должен быть
сохранен в HP
• каждая работа должна быть распределена на
какой-либо процессор и только на один
процессор.
L L
i j L j i L
HP транзитивное замыкание HP
p p HP p p HP

  
*
* *
( , ) ( , ) ,
L  HPL
Временная диаграмма выполнения
программы
2 3 5
4
PU1
PU2
время
1
6 7
7
1 3
6
4 5
2
Формальная постановка задачи
построения расписаний
• Дано:
– H = (P, L ) - модель программы,
– Tr = f(HP) - функция построения временной
диаграммы.
• Задача:
– построить расписание HP.
• Критерий оптимальности:
• Ограничения:
min ( ( , ))
*
T f H HP
HPHP
* HP  HP
HP* – множество расписаний удовлетворяющих условиям
корректности. (Множество корректных расписаний)
Базовая система операций
преобразования расписаний
ярусное представление
2
O1
O2
Теорема. Для любых двух корректных
расписаний HP1 и HP2
существует цепочка
операций {O1
, O2
}, переводящая расписание
HP1 в HP2
так, что каждое промежуточное
расписание корректно и длина цепочки <=2N.
SP1
:
SP2
:
2 3 6
1
5
4
7
1
3
4
6
5
7
.
Доказательство теоремы
1. Нумерация вершин графа H является сквозной, удовлетворяет
условиям полной топологической сортировки и предшествинник
всегда имеет меньший номер.
2. Введем понятие канонического расписания HP0
: все вершины
находятся в SP1
 и порядковые вершин в SP1
 равны номерам вершин
в графе H.
3. Доказываем, что существует стратегия (последовательность выбора
вершин) с числом шагов K  N позволяющая перевести
произвольное расписание HP в расписание HP0
, такая, что все
промежуточные расписания HPi (полученные после выполнения
отдельной операции Oi
) являются допустимыми и любая операция из
цепочки является обратимой.
4. Поскольку, каждая операция из цепочки обратима, то существует
стратегия перехода от HP0
 к произвольному HP, такая, что все K
промежуточных расписаний являются допустимыми и KN. 
Теорема (граф. ил. доказательства)
7
1 3
6
4 5
2
1
2
3
6
4
5
7
Теорема (граф. ил. доказательства)
7
1 3
6
4 5
2
1
2
3
6
4
5
7
Теорема (граф. ил. доказательства)
7
1 3
6
4 5
2
1
2
3
6
4
5
7
Теорема (граф. ил. доказательства)
7
1 3
6
4 5
2
1
2
3
5
4
6
7
.
Костенко В.А. Задача построения расписания при совместном
проектировании аппаратных и программных средств //
Программирование - 2002. - №3 - С.64-80.
Kostenko V.A. The Problem of Schedule Construction in the Joint
Design of Hardware and Software. // Programming and Computer
Software – 2002. -Vol. 28 - № 3 - pp.162–173.
Направленные стратегии применения
операций
Стратегия уменьшения задержек.
Утверждение. Если время начала выполнения каждой
работы равно длине критического пути в графе потока
данных, то расписание будет иметь минимальное время
выполнения.
Стратегия заполнения простоев.
Утверждение. Если простоев процессоров нет, то
расписание будет иметь минимальное время выполнения. 
Пример - Анализ временной диаграммы
для устранения простоев процессоров
- передача данных
- простой процессора
- процесс
причины возникновения простоев:
ожидание работой завершения предшественника
ожидание освобождения разделяемого ресурса
1 4 7
5
t
2
3 6
6
2 4
3
5 7
1
1 4 7
5
t
2
3 6
Метрика в пространстве корректных
расписаний
Определение. Расстояние между расписаниями HP1 и HP2
определим как число, равное длине минимальной
последовательности операций преобразования {O1
, O2
}, которая
переводит расписание HP1
 в расписание HP2
, так, что все
промежуточные расписания корректны.
Утверждение. Введенное расстояние между расписаниями
является метрикой.
Динамический закон понижения температуры
стандартная функция модификация стандартной функции
kt - порог начала повышения T, k – количество итераций без улучшения решения
Уменьшение количества итераций на 6-10% с сохранением качества
решения
max(0, ( )), )
ln(1 )
min( 0
0
c k k T
i
T
T t t  


ln(1 )
0
i
T
T


f(X)
X
Способы распараллеливания алгоритмов
• Универсальные способы распараллеливания
итерационных алгоритмов
– Запуск с различными начальными приближениями
– Запуск конвейера
• Распараллеливание имитационной модели
• Способы распараллеливания, опирающиеся на
особенности задачи
– Декомпозиции целевой функции
– Декомпозиции пространства решений
Схема параллельного асинхронного алгоритма
.
Initial_solution1
. . . . . .
New_local
solution1
Best_global
solution
Best_local
solution1
Initial_solutioni
New_local
solutioni
Best_local
solutioni
Initial_solutionn
New_local
solutionn
Best_local
solutionn
Схема параллельного алгоритма с
синхронизацией
.
Stop
condition
Initial_solution . . . . . .
New_local
solution1
Best_local
solution1
Initial_solution
New_local
solutioni
Best_local
solutioni
Initial_solution
New_local
solutionn
Best_local
solutionn
Gather best solutions
Broadcast best solution
Best
solution
yes
no
.
Способы обмена полученными решениями и
стратегии принятия решения в качестве
текущего
•Процесс i посылает процессу i+1 своё текущее решение.
Процесс i+1 принимает это решение в качестве текущего,
если F(Xi
) < F(Xi+1).
•Широковещательный обмен. Принятие j-ым процессом
решения от i-ого процесса в качестве текущего, если F(Xi
) <
F(Xj
) и i < j.
•Отправка текущих решений координатору, выбор из них
произвольного (возможно с разными вероятностями, в
зависимости от значений целевой функции) и принятие его в
качестве текущего всеми процессами.
.
Алгоритм, основанный на декомпозиции
целевой функции
Большую часть времени алгоритм имитации отжига
затрачивает на вычисление целевой функции.
Если целевая функция является декомпозируемой
F(x1
, x2
, … , xi
, … , xn
) = F(x1
) + … + F(xi
) + … +F(xn
),
то возможно параллельное её вычисление на m
(m≤n) процессорах. 
.
Подходы, основанные на декомпозиции
пространства решений
Декомпозиция на
области
О1 О2
Оi
Оn
Поиск решения в
О1, О2
Поиск решения в
Оi, Оi+1
Поиск решения в
Оn-1, Оn
Выбор наилучшего
решения
Распределение
областей по
процессам
… …
Распараллеливание на основе
декомпозиции пространства решений
• Задачи, требующие решения :
– Разбиение пространства корректных
расписаний на непересекающиеся области.
– Модификация операций преобразования
расписания.
– Поиск оптимального расписания в каждой
области отдельно.
– Отсечение областей, которые заведомо не
содержат оптимального решения.
– Распределение областей по узлам ВС.
Разбиение на области
( ) ( )
( , )
B i B j
j i L
HP p HP p
p p HP


( ) ( )
( , )
B i B j
i j L
HP p HP p
p p HP


Исходная область
Выбор двух работ, не
связанных отношением
порядка
Область 1
Область 2
Область 3
5
1
2 3 4
5
1
2 3 4
5
1
2 3 4
( ) ( ) B i B j HP p HP p
2,
3 i j
p p
Распределение по узлам
1 2 3 n
n+1 n+2 n+3 2n
N-n-1 N-n N-n+1 N-2
N-1 N
Proc 1 Proc 2 Proc 3 Proc n
i
Номер области
Область
Области отсортированы в порядке возрастания
нижней оценки целевой функции
Результаты исследования параллельного
алгоритма имитации отжига
0% 20% 40% 60% 80% 100%
Высокая связность
Средняя связность
Низкая связность
С
т
е
п
е
н
ь
с
в
я
з
н
о
с
т
и
г
р
а
ф
а
Параллельный,
испольующий разбиенеие
на области (8 узлов)
Параллельный,
испольующий разбиенеие
на области (4 узла)
Сравнение параллельного алгоритма с последовательным, использующим
разбиение на области (100% - время работы последовательного алгоритма)
0% 20% 40% 60% 80% 100%
Высокая связность
Средняя связность
Низкая связность
С
т
е
п
е
н
ь
с
в
я
з
н
о
с
т
и
г
р
а
ф
а
Сравнение классического алгоритма и алгоритма, использующего разбиение
на области. (100% - время работы классического алгоритма)
.
Костенко В.А. Задача построения расписания при совместном
проектировании аппаратных и программных средств //
Программирование - 2002. - №3 - С.64-80.
Kostenko V.A. The Problem of Schedule Construction in the Joint
Design of Hardware and Software. // Programming and Computer
Software – 2002. -Vol. 28 - № 3 - pp.162–173.
Калашников А.В., Костенко В.А. Параллельный алгоритм
имитации отжига для построения многопроцессорных
расписаний // Известия РАН. Теория и системы управления. -
2008. -№ 3 - С.133-142.
A. V. Kalashnikov and V. A. Kostenko. A Parallel Algorithm of
Simulated Annealing for Multiprocessor Scheduling // Journal of
Computer and Systems Sciences International. – 2008. - Vol. 47 -
№ 3- pp.455-463.
.
Костенко В.А. Алгоритмы построения расписаний для
вычислительных систем реального времени, допускающие
использование имитационных моделей // Программирование -
2013. - №5 - С.53-71.
Kostenko V.A. Scheduling Algorithms for Real-Time Computing
Systems Admitting Simulation Models // Programming and
Computer Software, 2013, Vol. 39, № 5, pp.255–267.
Д.А.Зорин, В.А.Костенко. Алгоритм имитации отжига для
решения задач построения многопроцессорных расписаний //
Автоматика и телемеханика, 2014, № 10, С. 97-110.
D. A. Zorin, V. A. Kostenko. Algorithm to Simulate Annealing in
Problems of Multiprocessor Scheduling // Automation and Remote
Control, 2014, Vol. 75, No. 10, pp. 1790–1801. DOI:
10.1134/S0005117914100063
.
Задание 3 и 4:
Доказать, что введенное расстояние между
расписаниями является метрикой.
Доказать замкнутость и полноту модифицированной
системы операции в областях.
